<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: gtube.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: gtube.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>const ytsr = require('ytsr');
const ytdl = require('ytdl-core');

/** 
 * @classdesc Class representing the options that are used with ytdl.
 */
class Options {
    /**
     * @default true
     */
    safeSearch=true;
    /**
     * @default 20
     */
    limit=20;
    /**
     * @default null
     */
    nextpageRef=null;
    /**
     * @description Represents an Option
     * @constructor
     * @param {Boolean} safeSearch - filter adult content
     * @param {int} limit - maximum results at a time
     * @param {String} nextpageRef - reference from previous page
     */
    constructor(safeSearch=true,limit=20,nextpageRef=null){
        this.safeSearch = safeSearch;
        this.limit = limit;
        this.nextpageRef = nextpageRef;
        this.getMap = this.getMap.bind(this);
    }
    /**
     * @description returns the options as an object to be passed to ytdl
     * @returns {Object} Object data for passing to ytdl
     */
    getMap(){
        return {
            safeSearch : this.safeSearch,
            limit : this.limit,
            nextpageRef : this.nextpageRef
        };
    }
}
/** 
 * @classdesc Class representing a video Item.
 */
class Item {
    /**
     * @default {
            type:'video',
            live:false,
            title:'',
            link:'',
            thumbnail:'',
            author:{
                name:'',
                ref:'',
                verified:false
            },
            description:'',
            views:0,
            duration:'00:00',
            uploaded_at:'',
        }
     */
    data = {
        type:'video',
        live:false,
        title:'',
        link:'',
        thumbnail:'',
        author:{
            name:'',
            ref:'',
            verified:false
        },
        description:'',
        views:0,
        duration:'00:00',
        uploaded_at:'',
    }
    /**
     * @constructor
     * @param {Object} item - Contains the video data
     */
    constructor(item=this.data){
        this.data = item;
    }
}
/** 
 * @classdesc Class representing a YouTube instance.
 */
class Gtube {
    /**
     * @member {String}
     * @default ""
     * @description Stores your search string
     * @private
     */
    #search="";
    /**
     * @member {Options}
     * @description Stores the Options object to be sent with ytdl
     * @default new Options()
     * @private
     */
    #options=new Options();
    /**
     * @member {Boolean}
     * @default false
     * @description if ytdl had an error
     * @private
     */
    #error=false;
    /**
     * @member {Array}
     * @default new Array&lt;Item>();
     * @description Item list retrieved on search
     * @private
     */
    #items=[];
    /**
     * @description Represents a YouTube instance
     * @constructor
     * @param {String} search - Search string
     * @param {Options} options - Options
     */
    constructor(search,options=this.#options){
        this.#search = search;
        this.#options = options;
        this.process = this.process.bind(this);
        this._callback = this._callback.bind(this);
        this.getItemData = this.getItemData.bind(this);
    }
    /**
     * @description this method searches the provided search string on Youtube for video results.
     * @async
     * @public
     * @access public
     * @param {Boolean} newSearch - Defines if we are continuing search or starting a new one
     * @param {function} callback - Callback when searching is done. Done assign this until you're absolutely
     * sure what you're doing
     * @throws {Error}
     * @returns {Promise&lt;Boolean>} is search was successful or ended with error
     */
    async process(newSearch=false,callback=this._callback){
        this.#error=false;
        if(newSearch){
            this.#options.nextpageRef=null;
            this.#items = [];
        }
        const val = await ytsr(this.#search,this.#options.getMap());
        try{
            callback(val);
        }catch(ex){
            this.#error = true;
            throw new Error(ex+'\n'+val)
        }
        return !this.#error;
    }
    /**
     * @description This is the default callback for this.process
     * @access private
     * @private
     * @param {Object} result - Represents a result object
     */
    _callback(result){
        var items = result['items'];
        this.#options.nextpageRef = result['nextpageRef'];
        for(var i=0;i&lt;items.length;i++){
            if(items[i]['type']=='video'){
                var item = new Item(items[i]);
                this.#items.push(item);
            }
        }
    }
    /**
    * @param {Item} item - Video Item
    * @access public
    * @description Get ytdl videoInfo
    * @async
    * @public
    * @returns {Promise&lt;Object>} ytdl.videoInfo
    */
    async getItemData(item){
        var videoInfo = await ytdl.getInfo(item.data.link);
        //console.debug(videoInfo);
        return videoInfo;
    }
    /**
     * @description Get Basic ytdl information
     * @param {Item} item - Video Item
     * @access public
     * @async
     * @method
     * @public
     * @returns {Object} ytdl.videoInfo
     */
    async getBasicItemData(item){
        var videoInfo = await ytdl.getBasicInfo(item.data.link);
        return videoInfo;
    }
    /**
     * @description get current list of items
     * @public
     * @method
     */
    get items(){
        return this.#items;
    }
    /**
     * @description get current Options
     * @method
     * @public
     */
    get options(){
        return this.#options;
    }
    /**
     * @description get current search string
     * @method
     * @public
     */
    get search(){
        return this.#search;
    }
}

module.exports = {
    Options : Options,
    Gtube : Gtube,
    Item : Item
}</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="Gtube.html">Gtube</a></li><li><a href="Item.html">Item</a></li><li><a href="Options.html">Options</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.4</a> on Mon May 04 2020 22:09:14 GMT+0530 (India Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
